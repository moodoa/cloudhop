# ğŸ€ Cloudhop - ä¸€å€‹å¯æ„›é¢¨æ ¼çš„å³æ™‚ç¾¤èŠç¶²é æ‡‰ç”¨

Cloudhop æ˜¯ä¸€å€‹è¼•é‡ç´šã€åŒ¿åçš„å³æ™‚ç¾¤çµ„èŠå¤©ç¶²é æ‡‰ç”¨ã€‚ä½¿ç”¨è€…ç„¡éœ€è¨»å†Šï¼Œé€²å…¥ç¶²é å³å¯ç²å¾—ä¸€å€‹éš¨æ©Ÿçš„å…­ä½å…ƒåå…­é€²åˆ¶ IDï¼Œä¸¦ç«‹å³é–‹å§‹èˆ‡æ‰€æœ‰åœ¨ç·šä½¿ç”¨è€…é€²è¡Œäº¤æµã€‚

## âœ¨ ä¸»è¦åŠŸèƒ½

- **åŒ¿åèŠå¤©**: ç„¡éœ€è¨»å†Šæˆ–ç™»å…¥ï¼Œæ¯ä½ä½¿ç”¨è€…éƒ½æœƒè¢«åˆ†é…ä¸€å€‹ç¨ç‰¹çš„è‡¨æ™‚ IDã€‚
- **å³æ™‚è¨Šæ¯**: è¨Šæ¯æœƒå³æ™‚é¡¯ç¤ºåœ¨æ‰€æœ‰åœ¨ç·šä½¿ç”¨è€…çš„ç•«é¢ä¸Šã€‚
- **å·¦å³ä½ˆå±€**: ä½¿ç”¨è€…è‡ªå·±çš„è¨Šæ¯é¡¯ç¤ºåœ¨å³å´ï¼Œä»–äººè¨Šæ¯é¡¯ç¤ºåœ¨å·¦å´ï¼Œå°è©±æµæ¸…æ™°æ˜“è®€ã€‚
- **å¤šåª’é«”æ”¯æ´**: é™¤äº†æ–‡å­—ï¼Œé‚„æ”¯æ´åœ–ç‰‡å’Œå½±ç‰‡çš„å³æ™‚ä¸Šå‚³èˆ‡åˆ†äº«ã€‚
- **å¯æ„›é¢¨æ ¼ä»‹é¢**: æ¡ç”¨äº†ç¾æ¨‚è’‚çš„ç²‰è‰²ã€åœ“æ½¤ã€å¯æ„›çš„è¦–è¦ºé¢¨æ ¼ã€‚
- **ç³»çµ±è¨Šæ¯**: ä½¿ç”¨è€…çš„åŠ å…¥å’Œé›¢é–‹éƒ½æœƒæœ‰ç³»çµ±è¨Šæ¯æç¤ºã€‚
- **åœ¨ç·šäººæ•¸é¡¯ç¤º**: å³æ™‚é¡¯ç¤ºç•¶å‰èŠå¤©å®¤çš„åœ¨ç·šäººæ•¸ã€‚

## ğŸ› ï¸ æŠ€è¡“æ£§

- **å¾Œç«¯**: Python, Flask, Flask-SocketIO
- **å‰ç«¯**: HTML, CSS, JavaScript
- **å³æ™‚é€šè¨Šå”å®š**: WebSocket
- **WSGI ä¼ºæœå™¨**: Eventlet
- **è¨Šæ¯ä½‡åˆ—**: Redis (ç”¨æ–¼å¤šå‰¯æœ¬é–“çš„è¨Šæ¯åŒæ­¥)

## ğŸš€ å¦‚ä½•åœ¨æœ¬æ©Ÿé‹è¡Œ

è«‹ä¾ç…§ä»¥ä¸‹æ­¥é©Ÿä¾†è¨­å®šä¸¦é‹è¡Œæ­¤å°ˆæ¡ˆã€‚

### 1. å‰ç½®éœ€æ±‚

- Python 3.6+ (å»ºè­°ä½¿ç”¨ 3.9 æˆ–æ›´é«˜ç‰ˆæœ¬)
- `pip` (Python å¥—ä»¶å®‰è£å™¨)
- ä¸€å€‹æ­£å¸¸çš„ç¶²è·¯é€£ç·š
- **Redis ä¼ºæœå™¨**: ç¢ºä¿æ‚¨çš„æœ¬æ©Ÿå·²å®‰è£ä¸¦é‹è¡Œ Redis ä¼ºæœå™¨ (ä¾‹å¦‚é€é `brew install redis` ä¸¦ `brew services start redis`)

### 2. ä¸‹è¼‰æˆ–è¤‡è£½å°ˆæ¡ˆ

å°‡æ­¤å°ˆæ¡ˆçš„æ‰€æœ‰æª”æ¡ˆä¸‹è¼‰åˆ°æ‚¨é›»è…¦çš„æŸå€‹è³‡æ–™å¤¾ä¸­ (ä¾‹å¦‚ `cloudhop`)ã€‚

### 3. å»ºç«‹ä¸¦å•Ÿç”¨è™›æ“¬ç’°å¢ƒ

åœ¨çµ‚ç«¯æ©Ÿä¸­ï¼Œé€²å…¥æ‚¨çš„å°ˆæ¡ˆè³‡æ–™å¤¾ï¼Œç„¶å¾ŒåŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤ä¾†å»ºç«‹ä¸¦å•Ÿç”¨ Python è™›æ“¬ç’°å¢ƒã€‚é€™èƒ½ç¢ºä¿å°ˆæ¡ˆçš„ç›¸ä¾å¥—ä»¶èˆ‡æ‚¨çš„ç³»çµ±ç’°å¢ƒéš”é›¢ã€‚

```bash
# å»ºç«‹åç‚º venv çš„è™›æ“¬ç’°å¢ƒ
python3 -m venv venv

# åœ¨ macOS / Linux ä¸Šå•Ÿç”¨è™›æ“¬ç’°å¢ƒ
source venv/bin/activate
```

### 4. å®‰è£ç›¸ä¾å¥—ä»¶

å•Ÿç”¨è™›æ“¬ç’°å¢ƒå¾Œï¼Œä½¿ç”¨ `pip` å’Œæˆ‘å€‘æä¾›çš„ `requirements.txt` æª”æ¡ˆä¾†å®‰è£æ‰€æœ‰å¿…è¦çš„ Python å¥—ä»¶ã€‚

```bash
pip install -r requirements.txt
```

### 5. å•Ÿå‹•èŠå¤©å®¤ä¼ºæœå™¨

ä¸€åˆ‡æº–å‚™å°±ç·’ï¼åŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤ä¾†å•Ÿå‹•å¾Œç«¯ä¼ºæœå™¨ã€‚

```bash
python app.py
```

ä¼ºæœå™¨æˆåŠŸå•Ÿå‹•å¾Œï¼Œæ‚¨æœƒçœ‹åˆ°é¡ä¼¼ä»¥ä¸‹çš„è¨Šæ¯ï¼Œè¡¨ç¤ºå®ƒæ­£åœ¨ `0.0.0.0:5001` ä¸Šé‹è¡Œã€‚

```
(12345) wsgi starting up on http://0.0.0.0:5001
```

### 6. é€²å…¥èŠå¤©å®¤

æ‰“é–‹æ‚¨çš„ç¶²é ç€è¦½å™¨ï¼Œè¼¸å…¥ä»¥ä¸‹ä»»ä¸€ç¶²å€å³å¯é€²å…¥æ‚¨çš„èŠå¤©å®¤ï¼š

- `http://127.0.0.1:5001`
- `http://localhost:5001`

## ğŸ³ éƒ¨ç½²åˆ° Docker

æ‚¨å¯ä»¥å°‡æ‡‰ç”¨ç¨‹å¼æ‰“åŒ…æˆ Docker æ˜ åƒæª”ï¼Œä»¥ä¾¿åœ¨ä»»ä½•æ”¯æ´ Docker çš„ç’°å¢ƒä¸­é‹è¡Œã€‚

### 1. å‰ç½®éœ€æ±‚

- Docker Desktop (æˆ– Docker Engine) å·²å®‰è£ä¸¦é‹è¡Œã€‚

### 2. å»ºç½® Docker æ˜ åƒæª”

åœ¨å°ˆæ¡ˆæ ¹ç›®éŒ„ä¸‹ï¼ŒåŸ·è¡Œä»¥ä¸‹å‘½ä»¤å»ºç½®æ˜ åƒæª”ã€‚è«‹å°‡ `your_dockerhub_username` æ›¿æ›ç‚ºæ‚¨çš„ Docker Hub ä½¿ç”¨è€…åç¨±ã€‚

```bash
docker build -t your_dockerhub_username/cloudhop:latest .
```

### 3. æ¨é€æ˜ åƒæª”åˆ° Docker Hub (å¯é¸ï¼Œä½†æ¨è–¦)

å¦‚æœæ‚¨å¸Œæœ›åœ¨å…¶ä»–æ©Ÿå™¨æˆ– Kubernetes é›†ç¾¤ä¸­ä½¿ç”¨æ­¤æ˜ åƒæª”ï¼Œå»ºè­°å°‡å…¶æ¨é€åˆ° Docker Hubã€‚

```bash
docker login
docker push your_dockerhub_username/cloudhop:latest
```

### 4. é‹è¡Œ Docker å®¹å™¨

ç¢ºä¿æ‚¨çš„ Redis ä¼ºæœå™¨æ­£åœ¨é‹è¡Œ (å¦‚æœæ˜¯åœ¨ Docker å®¹å™¨ä¸­é‹è¡Œï¼Œè«‹ç¢ºä¿å…¶å¯è¢«è¨ªå•)ã€‚ç„¶å¾Œé‹è¡Œä»¥ä¸‹å‘½ä»¤å•Ÿå‹•æ‡‰ç”¨ç¨‹å¼å®¹å™¨ï¼š

```bash
docker run -p 5001:5001 -e REDIS_URL=redis://host.docker.internal:6379/0 your_dockerhub_username/cloudhop:latest
```

> **æ³¨æ„**: `host.docker.internal` æ˜¯ä¸€å€‹ç‰¹æ®Šçš„ DNS åç¨±ï¼Œå…è¨± Docker å®¹å™¨è¨ªå•ä¸»æ©Ÿçš„æœå‹™ã€‚å¦‚æœæ‚¨çš„ Redis é‹è¡Œåœ¨ä¸»æ©Ÿä¸Šï¼Œè«‹ä½¿ç”¨æ­¤é…ç½®ã€‚å¦‚æœ Redis é‹è¡Œåœ¨å¦ä¸€å€‹ Docker å®¹å™¨ä¸­ï¼Œæ‚¨å¯èƒ½éœ€è¦ä½¿ç”¨ Docker ç¶²è·¯ä¾†é€£æ¥å®ƒå€‘ã€‚

## â˜¸ï¸ éƒ¨ç½²åˆ° Kubernetes

å°‡ Cloudhop éƒ¨ç½²åˆ° Kubernetes é›†ç¾¤ï¼Œä»¥å¯¦ç¾é«˜å¯ç”¨æ€§ã€å¯æ“´å±•æ€§å’Œè‡ªå‹•åŒ–ç®¡ç†ã€‚

### 1. å‰ç½®éœ€æ±‚

- Kubernetes é›†ç¾¤ (ä¾‹å¦‚ Docker Desktop å…§å»ºçš„ Kubernetes æˆ– Minikube) å·²å•Ÿå‹•ä¸¦é‹è¡Œã€‚
- `kubectl` å‘½ä»¤åˆ—å·¥å…·å·²é…ç½®ä¸¦é€£æ¥åˆ°æ‚¨çš„é›†ç¾¤ã€‚
- æ‚¨çš„ `cloudhop` Docker æ˜ åƒæª”å·²æ¨é€åˆ° Docker Hub (æˆ–æ‚¨çš„ Kubernetes é›†ç¾¤å¯ä»¥è¨ªå•çš„ Registry)ã€‚

### 2. éƒ¨ç½² Redis æœå‹™

Redis ä½œç‚ºè¨Šæ¯ä½‡åˆ—ï¼Œæ˜¯å¤šå‰¯æœ¬èŠå¤©å®¤æ‡‰ç”¨ç¨‹å¼çš„å¿…è¦çµ„ä»¶ã€‚

```bash
kubectl apply -f redis-k8s.yaml
```

### 3. éƒ¨ç½²èŠå¤©å®¤æ‡‰ç”¨ç¨‹å¼

é€™å°‡éƒ¨ç½²æ‚¨çš„èŠå¤©å®¤æ‡‰ç”¨ç¨‹å¼çš„å¤šå€‹å‰¯æœ¬ï¼Œä¸¦é…ç½®å…¶é€£æ¥åˆ° Redisã€‚

```bash
kubectl apply -f chat-app-k8s.yaml
```

### 4. æª¢æŸ¥éƒ¨ç½²ç‹€æ…‹

æ‚¨å¯ä»¥æª¢æŸ¥ Pod å’Œæœå‹™çš„ç‹€æ…‹ï¼Œç¢ºä¿å®ƒå€‘éƒ½å·²æ­£å¸¸é‹è¡Œã€‚

```bash
kubectl get pods
kubectl get services
```

### 5. è¨ªå•æ‡‰ç”¨ç¨‹å¼

ç”±æ–¼æ‚¨ä½¿ç”¨çš„æ˜¯ Docker Desktop å…§å»ºçš„ Kubernetesï¼Œ`LoadBalancer` é¡å‹çš„æœå‹™é€šå¸¸æœƒè¢«æ˜ å°„åˆ° `localhost` çš„ä¸€å€‹éš¨æ©ŸåŸ ã€‚æœ€å¯é çš„è¨ªå•æ–¹å¼æ˜¯ä½¿ç”¨ `kubectl port-forward`ã€‚

é¦–å…ˆï¼Œç¢ºä¿æ‚¨çš„ `chat-app-service` æ­£åœ¨é‹è¡Œï¼š

```bash
kubectl get services
```

ç„¶å¾Œï¼Œå°‡æœ¬åœ°åŸ è½‰ç™¼åˆ°æœå‹™ï¼š

```bash
kubectl port-forward service/chat-app-service 8080:80
```

ä¿æŒæ­¤å‘½ä»¤åœ¨çµ‚ç«¯æ©Ÿä¸­é‹è¡Œï¼Œç„¶å¾Œåœ¨æ‚¨çš„ç¶²é ç€è¦½å™¨ä¸­è¨ªå•ï¼š

`http://localhost:8080`

---

å¸Œæœ›æ‚¨ç©å¾—æ„‰å¿«ï¼